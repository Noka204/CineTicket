<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chi Ti·∫øt Phim</title>
  <link rel="stylesheet" href="../../assets/css/Phim.css" />
  <script src="../../assets/js/login.js"></script> 
  <link rel="stylesheet" href="../../assets/css/details.css"> 

<body>
  <!-- Header (load t·ª´ file part/header.html) -->
  <div id="include-header"></div>

  <!-- Movie detail -->
  <div class="movie-detail-container" id="movieDetail">
    <!-- N·ªôi dung phim s·∫Ω ƒë∆∞·ª£c render b·∫±ng JS -->
  </div>


  <!-- Footer (load t·ª´ file part/footer.html) -->
  <div id="include-footer"></div>

  <script>
    // H√†m include HTML
    function includeHTML(id, file) {
      fetch(file)
        .then(res => res.text())
        .then(data => {
          document.getElementById(id).innerHTML = data;
          if (id === "include-header") {
            setTimeout(updateAuthButtons, 100); // C·∫≠p nh·∫≠t th√¥ng tin ƒëƒÉng nh·∫≠p sau khi header load xong
          }
        });
    }

    // G·ªçi load header v√† footer
    includeHTML("include-header", "../../part/header.html");
    includeHTML("include-footer", "../../part/footer.html");

    // L·∫•y ID phim t·ª´ URL v√† g·ªçi API
    const params = new URLSearchParams(window.location.search);
    const phimId = params.get("id");

    if (!phimId) {
      document.getElementById("movieDetail").innerHTML = "<p style='color:red'>Kh√¥ng t√¨m th·∫•y phim.</p>";
    } else {
      fetch(`https://localhost:7058/api/phim/get/${phimId}`)
        .then(res => res.json())
        .then(data => {
          if (!data.status || !data.data) {
            document.getElementById("movieDetail").innerHTML = "<p style='color:red'>Kh√¥ng t√¨m th·∫•y th√¥ng tin phim.</p>";
            return;
          }

          const movie = data.data;
          document.getElementById("movieDetail").innerHTML = `
            <div class="movie-poster" style="background-image: url('${movie.poster || '../../assets/images/default-poster.jpg'}')"></div>
            <div class="movie-info">
              <h1>${movie.tenPhim}</h1>
              <p><strong>Th·ªÉ lo·∫°i:</strong> ${movie.tenLoaiPhim}</p>
              <p><strong>Th·ªùi l∆∞·ª£ng:</strong> ${movie.thoiLuong} ph√∫t</p>
              <p><strong>ƒê·∫°o di·ªÖn:</strong> ${movie.daoDien}</p>
              <p><strong>M√¥ t·∫£:</strong> ${movie.moTa || 'Kh√¥ng c√≥ m√¥ t·∫£.'}</p>


            <a href="../../pages/booking/booking.html?phimId=${movie.maPhim}" class="btn-booking">üéü ƒê·∫∑t v√© ngay</a>

            </div>
          `;

          
        })
        .catch(err => {
          console.error("L·ªói:", err);
          document.getElementById("movieDetail").innerHTML = "<p style='color:red'>L·ªói khi t·∫£i d·ªØ li·ªáu phim.</p>";
        });
    }
  </script>
</body>
</html>
