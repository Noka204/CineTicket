<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Panel - Cinema Management</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      rel="stylesheet"
    />

    <style>
      :root {
        --sb-bg: #0b1220;
        --sb-bg-2: #10182b;
        --sb-border: #1e2a44;
        --sb-text: #c9d4f4;
        --sb-muted: #7c8aa1;
        --content-bg: #ffffff;
        --accent: #34d399;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        --sb-collapsed-w: 72px;
        --sb-expanded-w: 220px;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        background: #f2f4f8;
        font: 15px/1.45 system-ui, Segoe UI, Roboto, Ubuntu;
      }

      .layout {
        display: flex;
        min-height: 100vh;
        width: 100%;
        overflow: hidden;
      }
      .sidebar {
        position: sticky;
        top: 0;
        left: 0;
        height: 100vh;
        width: var(--sb-collapsed-w);
        background: linear-gradient(180deg, var(--sb-bg), #0e1629);
        color: var(--sb-text);
        border-right: 1px solid var(--sb-border);
        transition: width 0.2s ease;
        z-index: 5;
      }
      .sidebar:hover {
        width: var(--sb-expanded-w);
      }
      .sidebar .brand {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 14px;
        border-bottom: 1px solid var(--sb-border);
        white-space: nowrap;
      }
      .brand i {
        font-size: 20px;
        color: #ffd369;
      }
      .brand .label {
        opacity: 0;
        transform: translateX(-6px);
        transition: all 0.2s;
      }
      .sidebar:hover .brand .label {
        opacity: 1;
        transform: none;
      }
      .nav-wrap {
        padding: 10px 6px;
      }
      .nav-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 12px;
        margin: 6px;
        border-radius: 10px;
        color: var(--sb-text);
        text-decoration: none;
        white-space: nowrap;
        border: 1px solid transparent;
      }
      .nav-item i {
        width: 24px;
        text-align: center;
        font-size: 18px;
        color: #a8c0ff;
      }
      .nav-item .text {
        opacity: 0;
        transform: translateX(-8px);
        transition: all 0.2s;
      }
      .sidebar:hover .nav-item .text {
        opacity: 1;
        transform: none;
      }
      .nav-item:hover {
        background: var(--sb-bg-2);
        border-color: #24345a;
      }
      .nav-item.active {
        background: #10203b;
        border-color: #2b3f6b;
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.03);
      }
      .section-title {
        font-size: 0.78rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: var(--sb-muted);
        padding: 12px 16px 6px;
        opacity: 0;
        transition: opacity 0.2s;
        white-space: nowrap;
      }
      .sidebar:hover .section-title {
        opacity: 1;
      }

      .content {
        flex: 1;
        min-width: 0;
        background: var(--content-bg);
        box-shadow: var(--shadow);
        margin: 0;
        border-left: 0;
      }
      .content header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 18px;
        border-bottom: 1px solid #e6e9f0;
        background: #fff;
        position: sticky;
        top: 0;
        z-index: 2;
      }
      .content header .title {
        font-weight: 800;
        letter-spacing: 0.2px;
      }
      .iframe-wrap {
        height: calc(100vh - 62px);
      }
      .iframe-wrap iframe {
        width: 100%;
        height: 100%;
        border: 0;
        background: #fff;
      }

      .sidebar:not(:hover) .nav-item {
        justify-content: center;
      }
      .sidebar:not(:hover) .nav-item .text {
        display: none;
      }

      @media (max-width: 992px) {
        .sidebar {
          width: var(--sb-expanded-w);
        }
        .sidebar:hover {
          width: var(--sb-expanded-w);
        }
        .content header .btn-toggle {
          display: inline-flex;
        }
      }
      .btn-toggle {
        display: none;
      }
    </style>

    <!-- Frame-buster: nếu trang admin bị nhúng trong iframe → bật ra top -->
    <script>
      if (window.top !== window.self) {
        window.top.location.href = window.location.href;
      }
    </script>
  </head>
  <body>
    <div class="layout">
      <!-- SIDEBAR -->
      <aside class="sidebar" id="sidebar">
        <div class="brand">
          <i class="fa-solid fa-clapperboard"></i>
          <div class="label">
            <div style="font-weight: 800">Admin Panel</div>
            <div style="font-size: 0.8rem; color: var(--sb-muted)">
              Cinema Manager
            </div>
          </div>
        </div>

        <div class="nav-wrap">
          <div class="section-title">Điều hướng</div>

          <a
            class="nav-item active"
            data-url="phim.html"
            href="javascript:void(0)"
          >
            <i class="fa-solid fa-video"></i
            ><span class="text">Quản lý Phim</span>
          </a>

          <a
            class="nav-item"
            data-url="quanlytaikhoan.html"
            href="javascript:void(0)"
          >
            <i class="fa-solid fa-users"></i
            ><span class="text">Quản lý Tài Khoản</span>
          </a>

          <a class="nav-item" data-url="rap.html" href="javascript:void(0)">
            <i class="fa-solid fa-store"></i
            ><span class="text">Quản lý Rạp</span>
          </a>

          <a
            class="nav-item"
            data-url="phongchieu.html"
            href="javascript:void(0)"
          >
            <i class="fa-solid fa-building"></i
            ><span class="text">Quản lý Phòng Chiếu</span>
          </a>

          <a class="nav-item" data-url="bapnuoc.html" href="javascript:void(0)">
            <i class="fa-solid fa-martini-glass"></i
            ><span class="text">Đồ Ăn – Thức Uống</span>
          </a>

          <a
            class="nav-item"
            data-url="suatchieu.html"
            href="javascript:void(0)"
          >
            <i class="fa-solid fa-clock"></i
            ><span class="text">Quản lý Suất Chiếu</span>
          </a>

          <a class="nav-item" data-url="ve.html" href="javascript:void(0)">
            <i class="fa-solid fa-ticket"></i
            ><span class="text">Quản lý Vé</span>
          </a>

          <a
            class="nav-item"
            data-url="doanhthu.html"
            href="javascript:void(0)"
          >
            <i class="fa-solid fa-chart-bar"></i
            ><span class="text">Doanh thu</span>
          </a>

          <div class="section-title">Khác</div>
          <!-- Quay lại top-level, không chui vào iframe -->
          <a
            class="nav-item"
            href="/frontend/pages/Phim/index.html"
            target="_top"
            rel="noopener"
          >
            <i class="fa-solid fa-arrow-left"></i
            ><span class="text">Quay lại trang chủ</span>
          </a>
        </div>
      </aside>

      <!-- CONTENT -->
      <main class="content">
        <header>
          <div class="title">Hệ Thống Quản lý Phim</div>
          <button
            class="btn btn-outline-secondary btn-sm btn-toggle"
            id="btnToggle"
          >
            <i class="fa-solid fa-bars"></i>
          </button>
        </header>
        <div class="iframe-wrap">
          <iframe
            id="contentFrame"
            src="phim.html"
            title="Nội dung quản trị"
          ></iframe>
        </div>
      </main>
    </div>

    <script>
      const $ = (sel, root = document) => root.querySelector(sel);
      const $$ = (sel, root = document) =>
        Array.from(root.querySelectorAll(sel));

      function loadPage(url) {
        const frame = $("#contentFrame");
        if (!frame || !url) return;
        frame.src = url;
      }

      // Điều hướng các mục nội bộ (data-url) trong iframe
      $$(".nav-item[data-url]").forEach((a) => {
        a.addEventListener("click", () => {
          $$(".nav-item").forEach((x) => x.classList.remove("active"));
          a.classList.add("active");
          loadPage(a.getAttribute("data-url"));
        });
      });

      // Với các link KHÔNG có data-url (đi ra ngoài) → luôn mở top-level
      document.querySelectorAll(".nav-item:not([data-url])").forEach((a) => {
        a.addEventListener("click", (e) => {
          const url = a.getAttribute("href");
          if (!url || url === "javascript:void(0)") return;
          e.preventDefault();
          window.top.location.href = url; // thoát khỏi iframe
        });
      });

      // Toggle cho mobile
      const sidebar = $("#sidebar");
      const btnToggle = $("#btnToggle");
      if (btnToggle) {
        btnToggle.addEventListener("click", () => {
          if (sidebar.style.width === "0px") {
            sidebar.style.width = "var(--sb-expanded-w)";
          } else {
            const expanded = getComputedStyle(document.documentElement)
              .getPropertyValue("--sb-expanded-w")
              .trim();
            sidebar.style.width =
              getComputedStyle(sidebar).width === expanded
                ? "0px"
                : "var(--sb-expanded-w)";
          }
        });
      }

      // Hỗ trợ ?page= để mở thẳng một trang con
      (function bootFromQuery() {
        const qs = new URLSearchParams(location.search);
        const page = qs.get("page");
        if (page) {
          const hit = $(`.nav-item[data-url="${page}"]`);
          if (hit) {
            hit.click();
          } else {
            loadPage(page);
          }
        }
      })();
    </script>
  </body>
</html>
